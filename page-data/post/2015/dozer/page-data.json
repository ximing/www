{"componentChunkName":"component---src-templates-blog-post-tsx","path":"/post/2015/dozer/","result":{"data":{"site":{"siteMetadata":{"title":"一席之地","author":"xi ming"}},"markdownRemark":{"id":"d46400f7-9a30-5e1d-9b1a-ac1c61164c47","excerpt":"在进行云盘项目开发的时候，经常会遇到将领域模型转化为业务模型，或者将业务模型转化为符合要求的JSON格式，这里面就涉及到大量的 Java Bean to Java Bean 的映射，我们很容易会写出来下面的代码：  这让人很不爽，所以如果两个类结构一样，最常使用的是BeanUtils.copyProperties…","html":"<p>在进行云盘项目开发的时候，经常会遇到将领域模型转化为业务模型，或者将业务模型转化为符合要求的JSON格式，这里面就涉及到大量的 Java Bean to Java Bean 的映射，我们很容易会写出来下面的代码：</p>\n<p><img src=\"https://xming-images.oss-cn-beijing.aliyuncs.com/md/1582807349304-731778a7b87f46bd52ceff0ae52453c0.png\" alt=\"\"></p>\n<p>这让人很不爽，所以如果两个类结构一样，最常使用的是BeanUtils.copyProperties(src，aim)方法将一个对象的值赋给另一个对象，但是如果属性不同或者名称不同(上面的例子中opver就是一个是String一个是Long)这样是不可以的， 出于职业习惯，再造轮子之前先去翻了翻果然让我找到了<a href=\"http://dozer.sourceforge.net/\" title=\"dozer\">dozer</a>这个映射工具。</p>\n<h3 id=\"安装并使用\" style=\"position:relative;\">安装并使用<a href=\"#%E5%AE%89%E8%A3%85%E5%B9%B6%E4%BD%BF%E7%94%A8\" aria-label=\"安装并使用 permalink\" class=\"custom-class after\"><svg t=\"1685947446267\" class=\"icon\" viewBox=\"0 0 1024 1024\" version=\"1.1\" xmlns=\"http://www.w3.org/2000/svg\" p-id=\"4780\" xmlns:xlink=\"http://www.w3.org/1999/xlink\" width=\"25\" height=\"25\"><path d=\"M282.453333 676.693333m-181.333333 0a181.333333 181.333333 0 1 0 362.666667 0 181.333333 181.333333 0 1 0-362.666667 0Z\" fill=\"#FFCA5F\" p-id=\"4781\"></path><path d=\"M570.453333 111.36m-42.666666 0a42.666667 42.666667 0 1 0 85.333333 0 42.666667 42.666667 0 1 0-85.333333 0Z\" fill=\"#FFCA5F\" p-id=\"4782\"></path><path d=\"M388.053333 866.346667A208 208 0 0 1 241.066667 512l106.666666-106.666667 45.226667 45.226667-106.666667 106.666667A144 144 0 1 0 490.666667 760.32l107.733333-106.666667 45.226667 45.226667-107.733334 106.666667a207.146667 207.146667 0 0 1-147.84 60.8zM723.413333 617.173333l-45.226666-45.226666 100.906666-100.906667A144 144 0 1 0 576 267.52l-100.906667 100.906667-45.226666-45.44 100.906666-100.906667A208 208 0 0 1 824.32 516.266667z\" fill=\"#5C1CF7\" p-id=\"4783\"></path><path d=\"M442.794667 558.506667l134.570666-134.549334 45.248 45.269334-134.549333 134.549333z\" fill=\"#5C1CF7\" p-id=\"4784\"></path></svg></a></h3>\n<p>首先在pom.xml中插入下面的依赖，然后mvn install一下即可安装到项目中</p>\n<p><img src=\"https://xming-images.oss-cn-beijing.aliyuncs.com/md/1582807360120-2bf616a430032780601d5e8e03c2ee36.png\" alt=\"\"></p>\n<p>注意如果项目中依赖了mafka的jar包必须按照如下的方法写，否则程序无法运行</p>\n<p><img src=\"https://xming-images.oss-cn-beijing.aliyuncs.com/md/1582807372005-2bfef4ae791476ecaf06f333e2508b06.png\" alt=\"\"></p>\n<p>然后写好配置文件，加载到dozer中就可以直接映射class</p>\n<p><img src=\"http://images.yeanzhi.cn/1442904603595.png\" alt=\"\"></p>\n<p>更多的时候我们希望能够使用spring管理我们的依赖，只需要按照下面的写法即可导入配置文件到dozer并被spring所管理</p>\n<p><img src=\"http://images.yeanzhi.cn/1442904718952.png\" alt=\"\"></p>\n<h3 id=\"一些高级用法\" style=\"position:relative;\">一些高级用法<a href=\"#%E4%B8%80%E4%BA%9B%E9%AB%98%E7%BA%A7%E7%94%A8%E6%B3%95\" aria-label=\"一些高级用法 permalink\" class=\"custom-class after\"><svg t=\"1685947446267\" class=\"icon\" viewBox=\"0 0 1024 1024\" version=\"1.1\" xmlns=\"http://www.w3.org/2000/svg\" p-id=\"4780\" xmlns:xlink=\"http://www.w3.org/1999/xlink\" width=\"25\" height=\"25\"><path d=\"M282.453333 676.693333m-181.333333 0a181.333333 181.333333 0 1 0 362.666667 0 181.333333 181.333333 0 1 0-362.666667 0Z\" fill=\"#FFCA5F\" p-id=\"4781\"></path><path d=\"M570.453333 111.36m-42.666666 0a42.666667 42.666667 0 1 0 85.333333 0 42.666667 42.666667 0 1 0-85.333333 0Z\" fill=\"#FFCA5F\" p-id=\"4782\"></path><path d=\"M388.053333 866.346667A208 208 0 0 1 241.066667 512l106.666666-106.666667 45.226667 45.226667-106.666667 106.666667A144 144 0 1 0 490.666667 760.32l107.733333-106.666667 45.226667 45.226667-107.733334 106.666667a207.146667 207.146667 0 0 1-147.84 60.8zM723.413333 617.173333l-45.226666-45.226666 100.906666-100.906667A144 144 0 1 0 576 267.52l-100.906667 100.906667-45.226666-45.44 100.906666-100.906667A208 208 0 0 1 824.32 516.266667z\" fill=\"#5C1CF7\" p-id=\"4783\"></path><path d=\"M442.794667 558.506667l134.570666-134.549334 45.248 45.269334-134.549333 134.549333z\" fill=\"#5C1CF7\" p-id=\"4784\"></path></svg></a></h3>\n<p>dozer如果属性名相同可以自动映射很多类型比如String->Long ,Long->String,Data->Timestamp等等，几乎满足所有需求，但是项目中总有一些需要我们配置的奇葩现象，</p>\n<h4 id=\"1属性名不相同\" style=\"position:relative;\">1,属性名不相同<a href=\"#1%E5%B1%9E%E6%80%A7%E5%90%8D%E4%B8%8D%E7%9B%B8%E5%90%8C\" aria-label=\"1属性名不相同 permalink\" class=\"custom-class after\"><svg t=\"1685947446267\" class=\"icon\" viewBox=\"0 0 1024 1024\" version=\"1.1\" xmlns=\"http://www.w3.org/2000/svg\" p-id=\"4780\" xmlns:xlink=\"http://www.w3.org/1999/xlink\" width=\"25\" height=\"25\"><path d=\"M282.453333 676.693333m-181.333333 0a181.333333 181.333333 0 1 0 362.666667 0 181.333333 181.333333 0 1 0-362.666667 0Z\" fill=\"#FFCA5F\" p-id=\"4781\"></path><path d=\"M570.453333 111.36m-42.666666 0a42.666667 42.666667 0 1 0 85.333333 0 42.666667 42.666667 0 1 0-85.333333 0Z\" fill=\"#FFCA5F\" p-id=\"4782\"></path><path d=\"M388.053333 866.346667A208 208 0 0 1 241.066667 512l106.666666-106.666667 45.226667 45.226667-106.666667 106.666667A144 144 0 1 0 490.666667 760.32l107.733333-106.666667 45.226667 45.226667-107.733334 106.666667a207.146667 207.146667 0 0 1-147.84 60.8zM723.413333 617.173333l-45.226666-45.226666 100.906666-100.906667A144 144 0 1 0 576 267.52l-100.906667 100.906667-45.226666-45.44 100.906666-100.906667A208 208 0 0 1 824.32 516.266667z\" fill=\"#5C1CF7\" p-id=\"4783\"></path><path d=\"M442.794667 558.506667l134.570666-134.549334 45.248 45.269334-134.549333 134.549333z\" fill=\"#5C1CF7\" p-id=\"4784\"></path></svg></a></h4>\n<p>1，使用注解，如下</p>\n<p><img src=\"http://images.yeanzhi.cn/1442905219841.png\" alt=\"\"></p>\n<p><img src=\"http://images.yeanzhi.cn/1442905296278.png\" alt=\"\"></p>\n<p>2，xml 配置如下</p>\n<p><img src=\"http://images.yeanzhi.cn/1442905451043.png\" alt=\"\"></p>\n<p>其中a代表源，b代表目标，field代表我们需要映射的属性的名称，这里类型可以是不一样的，自动转换类型支持如下：</p>\n<blockquote>\n<p>Primitive to Primitive Wrapper Primitive to Custom Wrapper Primitive Wrapper to Primitive Wrapper Primitive to Primitive Complex Type to Complex Type String to Primitive String to Primitive Wrapper String to Complex Type if the Complex Type contains a String constructor String to Map Collection to Collection Collection to Array Map to Complex Type Map to Custom Map Type Enum to Enum Each of these can be mapped to one another: java.util.Date, java.sql.Date, java.sql.Time, java.sql.Timestamp, java.util.Calendar, java.util.GregorianCalendar String to any of the supported Date/Calendar Objects. Objects containing a toString() method that produces a long representing time in (ms) to any supported Date/Calendar object.</p>\n</blockquote>\n<p>会使用上面的方法，基本满足我们90%的日常开发,但是貌似还是有一些情况不能用这种方式自动转换，比如云盘经常会遇到String和Date互相转换的情况我们可以这么写</p>\n<p><img src=\"http://images.yeanzhi.cn/1442905904402.png\" alt=\"\"></p>\n<p>如果整个类里面有很多，可以提高date-format</p>\n<p><img src=\"http://images.yeanzhi.cn/1442905961467.png\" alt=\"\"></p>\n<p>如果整个配置文件所有类都需要转换，可以在提高date-format</p>\n<p><img src=\"http://images.yeanzhi.cn/1442906034311.png\" alt=\"\"></p>\n<p>这样就可以对整个文件所有时间类型进行转换</p>\n<h3 id=\"2自定义转换器\" style=\"position:relative;\">2,自定义转换器<a href=\"#2%E8%87%AA%E5%AE%9A%E4%B9%89%E8%BD%AC%E6%8D%A2%E5%99%A8\" aria-label=\"2自定义转换器 permalink\" class=\"custom-class after\"><svg t=\"1685947446267\" class=\"icon\" viewBox=\"0 0 1024 1024\" version=\"1.1\" xmlns=\"http://www.w3.org/2000/svg\" p-id=\"4780\" xmlns:xlink=\"http://www.w3.org/1999/xlink\" width=\"25\" height=\"25\"><path d=\"M282.453333 676.693333m-181.333333 0a181.333333 181.333333 0 1 0 362.666667 0 181.333333 181.333333 0 1 0-362.666667 0Z\" fill=\"#FFCA5F\" p-id=\"4781\"></path><path d=\"M570.453333 111.36m-42.666666 0a42.666667 42.666667 0 1 0 85.333333 0 42.666667 42.666667 0 1 0-85.333333 0Z\" fill=\"#FFCA5F\" p-id=\"4782\"></path><path d=\"M388.053333 866.346667A208 208 0 0 1 241.066667 512l106.666666-106.666667 45.226667 45.226667-106.666667 106.666667A144 144 0 1 0 490.666667 760.32l107.733333-106.666667 45.226667 45.226667-107.733334 106.666667a207.146667 207.146667 0 0 1-147.84 60.8zM723.413333 617.173333l-45.226666-45.226666 100.906666-100.906667A144 144 0 1 0 576 267.52l-100.906667 100.906667-45.226666-45.44 100.906666-100.906667A208 208 0 0 1 824.32 516.266667z\" fill=\"#5C1CF7\" p-id=\"4783\"></path><path d=\"M442.794667 558.506667l134.570666-134.549334 45.248 45.269334-134.549333 134.549333z\" fill=\"#5C1CF7\" p-id=\"4784\"></path></svg></a></h3>\n<p>上面的Date->String都是使用的dozer本身存在的转换器，我们可能需要使用一些自己自定义的转换器以满足自定义类的转换，这个时候就需要实现dozer为我们提供的接口:</p>\n<p><img src=\"https://xming-images.oss-cn-beijing.aliyuncs.com/md/1582807380899-c5508b65eed55ab0602f84170f4cd39a.png\" alt=\"\"></p>\n<p>然后在配置文件中可以如下写法</p>\n<p><img src=\"http://images.yeanzhi.cn/1442976346573.png\" alt=\"\"></p>\n<h3 id=\"3更多\" style=\"position:relative;\">3,更多<a href=\"#3%E6%9B%B4%E5%A4%9A\" aria-label=\"3更多 permalink\" class=\"custom-class after\"><svg t=\"1685947446267\" class=\"icon\" viewBox=\"0 0 1024 1024\" version=\"1.1\" xmlns=\"http://www.w3.org/2000/svg\" p-id=\"4780\" xmlns:xlink=\"http://www.w3.org/1999/xlink\" width=\"25\" height=\"25\"><path d=\"M282.453333 676.693333m-181.333333 0a181.333333 181.333333 0 1 0 362.666667 0 181.333333 181.333333 0 1 0-362.666667 0Z\" fill=\"#FFCA5F\" p-id=\"4781\"></path><path d=\"M570.453333 111.36m-42.666666 0a42.666667 42.666667 0 1 0 85.333333 0 42.666667 42.666667 0 1 0-85.333333 0Z\" fill=\"#FFCA5F\" p-id=\"4782\"></path><path d=\"M388.053333 866.346667A208 208 0 0 1 241.066667 512l106.666666-106.666667 45.226667 45.226667-106.666667 106.666667A144 144 0 1 0 490.666667 760.32l107.733333-106.666667 45.226667 45.226667-107.733334 106.666667a207.146667 207.146667 0 0 1-147.84 60.8zM723.413333 617.173333l-45.226666-45.226666 100.906666-100.906667A144 144 0 1 0 576 267.52l-100.906667 100.906667-45.226666-45.44 100.906666-100.906667A208 208 0 0 1 824.32 516.266667z\" fill=\"#5C1CF7\" p-id=\"4783\"></path><path d=\"M442.794667 558.506667l134.570666-134.549334 45.248 45.269334-134.549333 134.549333z\" fill=\"#5C1CF7\" p-id=\"4784\"></path></svg></a></h3>\n<p>上面说的基本上可以满足99%的业务需求，不过dozer还有很多奇妙的用法，可以访问<a href=\"http://dozer.sourceforge.net/\" title=\"dozer官网\">dozer官网</a>学习。</p>","fields":{"slug":"/post/2015/dozer/"},"tableOfContents":"<ul>\n<li>\n<p><a href=\"#%E5%AE%89%E8%A3%85%E5%B9%B6%E4%BD%BF%E7%94%A8\">安装并使用</a></p>\n</li>\n<li>\n<p><a href=\"#%E4%B8%80%E4%BA%9B%E9%AB%98%E7%BA%A7%E7%94%A8%E6%B3%95\">一些高级用法</a></p>\n<ul>\n<li><a href=\"#1%E5%B1%9E%E6%80%A7%E5%90%8D%E4%B8%8D%E7%9B%B8%E5%90%8C\">1,属性名不相同</a></li>\n</ul>\n</li>\n<li>\n<p><a href=\"#2%E8%87%AA%E5%AE%9A%E4%B9%89%E8%BD%AC%E6%8D%A2%E5%99%A8\">2,自定义转换器</a></p>\n</li>\n<li>\n<p><a href=\"#3%E6%9B%B4%E5%A4%9A\">3,更多</a></p>\n</li>\n</ul>","frontmatter":{"title":"dozer使用","date":"2015年09月23日","description":null,"tags":["dozer","java"]},"wordCount":{"words":181,"paragraphs":24,"sentences":25}}},"pageContext":{"slug":"/post/2015/dozer/","previous":{"fields":{"slug":"/post/2015/my-second-post/"},"frontmatter":{"title":"My Second Post!","tags":null,"description":null}},"next":{"fields":{"slug":"/post/2015/spring-aop/"},"frontmatter":{"title":"spring aop 权限拦截","tags":["spring","java"],"description":null}}}},"staticQueryHashes":["2887002447","3110208747","3255319198","63159454"],"slicesMap":{}}
{"componentChunkName":"component---src-templates-blog-post-tsx","path":"/post/2018/log/","result":{"data":{"site":{"siteMetadata":{"title":"一席之地","author":"xi ming"}},"markdownRemark":{"id":"072ec28b-3e43-52c2-9784-754063230c08","excerpt":"背景 小程序开发的过程中，我们遇到一个比较麻烦的问题，在真机调试的时候是看不到日志的。本来我们只需要支持美团小程序，这个情况还可以通过VConsole来处理，但是后面我们开始支持美团小程序开发的时候，因为机制问题没有支持service…","html":"<h3 id=\"背景\" style=\"position:relative;\">背景<a href=\"#%E8%83%8C%E6%99%AF\" aria-label=\"背景 permalink\" class=\"custom-class after\"><svg t=\"1685947446267\" class=\"icon\" viewBox=\"0 0 1024 1024\" version=\"1.1\" xmlns=\"http://www.w3.org/2000/svg\" p-id=\"4780\" xmlns:xlink=\"http://www.w3.org/1999/xlink\" width=\"25\" height=\"25\"><path d=\"M282.453333 676.693333m-181.333333 0a181.333333 181.333333 0 1 0 362.666667 0 181.333333 181.333333 0 1 0-362.666667 0Z\" fill=\"#FFCA5F\" p-id=\"4781\"></path><path d=\"M570.453333 111.36m-42.666666 0a42.666667 42.666667 0 1 0 85.333333 0 42.666667 42.666667 0 1 0-85.333333 0Z\" fill=\"#FFCA5F\" p-id=\"4782\"></path><path d=\"M388.053333 866.346667A208 208 0 0 1 241.066667 512l106.666666-106.666667 45.226667 45.226667-106.666667 106.666667A144 144 0 1 0 490.666667 760.32l107.733333-106.666667 45.226667 45.226667-107.733334 106.666667a207.146667 207.146667 0 0 1-147.84 60.8zM723.413333 617.173333l-45.226666-45.226666 100.906666-100.906667A144 144 0 1 0 576 267.52l-100.906667 100.906667-45.226666-45.44 100.906666-100.906667A208 208 0 0 1 824.32 516.266667z\" fill=\"#5C1CF7\" p-id=\"4783\"></path><path d=\"M442.794667 558.506667l134.570666-134.549334 45.248 45.269334-134.549333 134.549333z\" fill=\"#5C1CF7\" p-id=\"4784\"></path></svg></a></h3>\n<p>小程序开发的过程中，我们遇到一个比较麻烦的问题，在真机调试的时候是看不到日志的。本来我们只需要支持美团小程序，这个情况还可以通过VConsole来处理，但是后面我们开始支持美团小程序开发的时候，因为机制问题没有支持service里面的日志没有打印出来，就这个问题就很麻烦了。</p>\n<p>另外很多时候我们需要查看网络请求具体的内容和返回，copy为curl 和后端联调，这个目前就都没有什么方案，所以我们开始想弄一个实时日志的功能。</p>\n<p>因为我没来做新零售之前负责大象实时协作文档的架构与研发，所以这个工具做起来还是比较轻松的，完全可以复用整个实时协作的基础设施，只需要考虑如何将小程序接入以及如何后台展示即可。</p>\n<h3 id=\"整体设计\" style=\"position:relative;\">整体设计<a href=\"#%E6%95%B4%E4%BD%93%E8%AE%BE%E8%AE%A1\" aria-label=\"整体设计 permalink\" class=\"custom-class after\"><svg t=\"1685947446267\" class=\"icon\" viewBox=\"0 0 1024 1024\" version=\"1.1\" xmlns=\"http://www.w3.org/2000/svg\" p-id=\"4780\" xmlns:xlink=\"http://www.w3.org/1999/xlink\" width=\"25\" height=\"25\"><path d=\"M282.453333 676.693333m-181.333333 0a181.333333 181.333333 0 1 0 362.666667 0 181.333333 181.333333 0 1 0-362.666667 0Z\" fill=\"#FFCA5F\" p-id=\"4781\"></path><path d=\"M570.453333 111.36m-42.666666 0a42.666667 42.666667 0 1 0 85.333333 0 42.666667 42.666667 0 1 0-85.333333 0Z\" fill=\"#FFCA5F\" p-id=\"4782\"></path><path d=\"M388.053333 866.346667A208 208 0 0 1 241.066667 512l106.666666-106.666667 45.226667 45.226667-106.666667 106.666667A144 144 0 1 0 490.666667 760.32l107.733333-106.666667 45.226667 45.226667-107.733334 106.666667a207.146667 207.146667 0 0 1-147.84 60.8zM723.413333 617.173333l-45.226666-45.226666 100.906666-100.906667A144 144 0 1 0 576 267.52l-100.906667 100.906667-45.226666-45.44 100.906666-100.906667A208 208 0 0 1 824.32 516.266667z\" fill=\"#5C1CF7\" p-id=\"4783\"></path><path d=\"M442.794667 558.506667l134.570666-134.549334 45.248 45.269334-134.549333 134.549333z\" fill=\"#5C1CF7\" p-id=\"4784\"></path></svg></a></h3>\n<p><img src=\"https://xming-images.oss-cn-beijing.aliyuncs.com/md/1582807458172-29cad81dea3d2e1912002d86c755daea.png\" alt=\"\"></p>\n<p>在小程序端上提供统一的日志模块，将所有被记录的日志放到日志缓冲池里面，这样在APP刚启动还没有建立长连接之前的日志不会丢失，然后通过长连SDK来消费缓冲池里面的日志数据。</p>\n<p>这里面有一个需要思考的是传递给服务端的包信息要如何设计，ha</p>\n<p>需要解决两个问题，一个是日志如何</p>\n<p><img src=\"https://xming-images.oss-cn-beijing.aliyuncs.com/md/1582807463227-477312b84d1ce6876072f48b81c72664.png\" alt=\"\"></p>\n<p><img src=\"https://xming-images.oss-cn-beijing.aliyuncs.com/md/1582807468324-7647a75f8c1f2217c3141cf9351b854a.png\" alt=\"\"></p>\n<h3 id=\"参考资料\" style=\"position:relative;\">参考资料<a href=\"#%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99\" aria-label=\"参考资料 permalink\" class=\"custom-class after\"><svg t=\"1685947446267\" class=\"icon\" viewBox=\"0 0 1024 1024\" version=\"1.1\" xmlns=\"http://www.w3.org/2000/svg\" p-id=\"4780\" xmlns:xlink=\"http://www.w3.org/1999/xlink\" width=\"25\" height=\"25\"><path d=\"M282.453333 676.693333m-181.333333 0a181.333333 181.333333 0 1 0 362.666667 0 181.333333 181.333333 0 1 0-362.666667 0Z\" fill=\"#FFCA5F\" p-id=\"4781\"></path><path d=\"M570.453333 111.36m-42.666666 0a42.666667 42.666667 0 1 0 85.333333 0 42.666667 42.666667 0 1 0-85.333333 0Z\" fill=\"#FFCA5F\" p-id=\"4782\"></path><path d=\"M388.053333 866.346667A208 208 0 0 1 241.066667 512l106.666666-106.666667 45.226667 45.226667-106.666667 106.666667A144 144 0 1 0 490.666667 760.32l107.733333-106.666667 45.226667 45.226667-107.733334 106.666667a207.146667 207.146667 0 0 1-147.84 60.8zM723.413333 617.173333l-45.226666-45.226666 100.906666-100.906667A144 144 0 1 0 576 267.52l-100.906667 100.906667-45.226666-45.44 100.906666-100.906667A208 208 0 0 1 824.32 516.266667z\" fill=\"#5C1CF7\" p-id=\"4783\"></path><path d=\"M442.794667 558.506667l134.570666-134.549334 45.248 45.269334-134.549333 134.549333z\" fill=\"#5C1CF7\" p-id=\"4784\"></path></svg></a></h3>\n<ol>\n<li><a href=\"https://en.wikipedia.org/wiki/HAR_(file_format)\">https://en.wikipedia.org/wiki/HAR_(file_format)</a></li>\n<li><a href=\"https://fileinfo.com/extension/har\">https://fileinfo.com/extension/har</a></li>\n<li><a href=\"http://www.softwareishard.com/blog/har-12-spec/\">http://www.softwareishard.com/blog/har-12-spec/</a></li>\n</ol>","fields":{"slug":"/post/2018/log/"},"tableOfContents":"<ul>\n<li><a href=\"#%E8%83%8C%E6%99%AF\">背景</a></li>\n<li><a href=\"#%E6%95%B4%E4%BD%93%E8%AE%BE%E8%AE%A1\">整体设计</a></li>\n<li><a href=\"#%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99\">参考资料</a></li>\n</ul>","frontmatter":{"title":"小程序实时日志","date":"2018年05月01日","description":null,"tags":["小程序","日志","实践"]},"wordCount":{"words":41,"paragraphs":13,"sentences":13}}},"pageContext":{"slug":"/post/2018/log/","previous":{"fields":{"slug":"/post/2018/DI&IOC基本概念/"},"frontmatter":{"title":"DI&IOC基本概念","tags":["IOC"],"description":null}},"next":{"fields":{"slug":"/post/2018/算法题-spiral/"},"frontmatter":{"title":"算法题-螺旋化","tags":["codewars","code"],"description":null}}}},"staticQueryHashes":["2887002447","3110208747","3255319198","63159454"],"slicesMap":{}}